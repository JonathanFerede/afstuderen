# Paste from excel 95%

## Aanleiding

Veel van de productinformatie en vertalingen die aangeleverd word bij e-commerce worden aangeleverd in excel bestanden. Met de huidige interface moet er los vanuit elke cel naar elk invoerveld gekopieerd en geplakt worden. Daarom is er onderzocht of het mogelijk is om meerdere cellen vanuit excel te kopiëren en te plakken in meerdere HTML invoervelden. 

## Methode

Om erachter te komen of het mogelijk is om data uit meerdere cellen vanuit excel te kopiëren en te plakken in meerdere HTML invoervelden moeten eerst de volgende vragen beantwoord worden:

### Hoe ziet de clipboard data opgesplitst worden voor elk invoerveld?

Wanneer er meerdere cellen gekopieerd worden ziet de 'clipboard-data' eruit als een string. Deze string kan omgezet worden naar een array met de volgende RegEx.  

```text
var arr = str.split(/[\r\n]/g);
```

Hoe kan de er in meerdere invoervelden tegelijkertijd geplakt worden?

De mogelijkheid om clipboard data in te zien of aanpassen kan misbruikt worden. En daarom werkt het niet meer. Pas als de data geplakt is in de pagina kan er iets mee gedaan worden. 

Oplossing: 

1. Eerst in ander veld plakken 
2. Trigger functie na plakken die controleerd of geplakte data /n bevat en deze data opnieuw op de juiste manier over invoervelden verdeelt. 



## Resultaat

![](../.gitbook/assets/paste_from_excel.gif)

### Vervolg onderzoek

Wat wel kan is een functie uitvoeren direct na dat er iets geplakt is. 



In een verbeterde versie van deze feature zou het mogelijk moeten zijn om een aantal invoervelden te selecteren in zonder _&lt;textarea&gt;_ direct de plakken. 

Wanneer er meer velden gekopiëerd worden dan dat er invoervelden zijn, of wanneer de invoervelden bepaalde inhoud niet toestaan zou de gebruiker een melding moeten krijgen. In dit prototype gebeurt dat namelijk niet. 

Alleen plakken in de door de gebruiker geselecteerde invoervelden. 

Werkt deze functie goed samen met [sortable form](1.-sortable-form.md)?

## Downloads

{% file src="../.gitbook/assets/paste\_from\_excel.zip" caption="Download prototype" %}

